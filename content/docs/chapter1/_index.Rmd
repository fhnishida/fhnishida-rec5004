---
date: "2018-09-09T00:00:00Z"
# icon: book
# icon_pack: fas
linktitle: R Toolkit
summary: Learn how to use Wowchemy's docs layout for publishing online courses, software
  documentation, and tutorials.
title: R Toolkit
weight: 1
output: md_document
type: book
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

- Baseado, principalmente, nos cursos da [_Especializa√ß√£o em Data Science_](https://www.coursera.org/specializations/jhu-data-science) da universidade John Hopkins (dispon√≠vel no Coursera).
- Em cada tema abordado ser√£o citadas as fontes, al√©m de incluir aos v√≠deos dos cursos citados acima para que possam aprofundar nos estudos.
- Alunos USP conseguem fazer determinados cursos/especializa√ß√µes e pegar o certificado sem pagar: [_Universidade de S√£o Paulo BR on Coursera_](https://www.coursera.org/programs/universidade-de-sao-paulo-br-on-coursera-mvxtw?currentTab=CATALOG&fbclid=IwAR3dT_SDYfjT2FWH06mUcSb8V_z4F9aT_1c6MHHQ3gdiDQ9X9mdRhMcsbOk)


## Installing R
- [Installing R (John Hopkins/Coursera)](https://www.coursera.org/learn/data-scientists-tools/lecture/y6mU2/installing-r)

1. Instala√ß√£o da base do R ([CRAN](https://cran.r-project.org))
    - Download R for Windows > base > Download R X.X.X for Windows
    - Se o computador for 64-bits, opte pela vers√£o 64-bits (√© mais r√°pida)

2. Instala√ß√£o do Rtools ([CRAN](https://cran.r-project.org))
    - Download R for Windows > Rtools > Installing Rtools > rtools40-x86_XX.exe
    - √â um conjunto de ferramentas de compila√ß√£o de v√°rias linguagens (C, C++ e Fortran) que s√£o necess√°rios em alguns pacotes no R

3. Instala√ß√£o do RStudio ([RStudio Dowload](https://www.rstudio.com/products/rstudio/download/#download))
    - Download RStudio Desktop
    - √â uma interface de usu√°rio para facilitar o uso do R

## Using R Studio
- [RStudio Tour (John Hopkins/Coursera)](https://www.coursera.org/learn/data-scientists-tools/lecture/0fUNC/rstudio-tour)

RStudio √© dividido em 4 quadrantes:

- superior/esquerdo: source - onde ficam "blocos de nota" (scripts) com comandos a serem salvos
- superior/direito: ambiente - visualizar vari√°veis
- inferior/esquerdo: console - executar os comandos e ver resultados (√© o R "bruto")
- inferior/direito: arquivos/gr√°ficos/pacotes/ajuda

> **Dica**: Alterar o tema do RStudio (fundo branco pode cansar mais a vis√£o num tempo mais longo)<br/>  
Tools > Global Options... > Appearance > Editor theme > Cobalt (meu preferido)

### Diret√≥rio de trabalho (_Working Directory_)
Definir um diret√≥rio de trabalho facilita o acesso aos arquivos da pasta (base de dados, etc.).

> Session > Set Working Directory > Choose Directory...

```r
setwd("C:/Users/Fabio/OneDrive/FEA-RP")
```

> **Dica**: O comando para definir o diret√≥rio de trabalho aparecer√° no console. Copie e cole no seu script para n√£o precisar definir toda vez que abre o R Studio.

- Note que usa o "slash" (/) ao inv√©s do "backslash" (\\), ent√£o n√£o d√° para copiar diretamente o endere√ßo de uma pasta e colar no R sem fazer ajustes:
```r
setwd("C:\Users\Fabio\OneDrive\FEA-RP") # ERRADO!
```

```r
setwd("C:/Users/Fabio/OneDrive/FEA-RP") # CORRETO!
setwd("C:\\Users\\Fabio\\OneDrive\\FEA-RP") # CORRETO!
```

Voc√™ pode trocar _backslash_ por _slash_, ou duplicar os _backslashs_.

### Executando comandos no R
- Execu√ß√£o direta no console: escreva `1 + 1` no console e d√™ \<Enter\>
```{r}
1 + 1
```
- Execu√ß√£o pelo script: escreva o seguinte c√≥digo abaixo, e d√™ `Ctrl + Enter` na linha ou no c√≥digo destacado. Note que o c√≥digo do script √© "jogado" no console.
```{r}
rnorm(n=10, mean=0, sd=1)  # Gerar 10 n√∫meros ~ N(0, 1)
hist(rnorm(n=1000, mean=0, sd=1))  # Histograma dos n√∫meros gerados
```



### Ajuda para comandos
```r
?rnorm
```

```yaml
rnorm(n, mean = 0, sd = 1)

n: number of observations. If length(n) > 1, the length is taken to be the number required.
mean: vector of means.
sd: vector of standard deviations.
```

- Note acima em "Usage" que j√° h√° valores pr√©-definidos para `mean = 0` e `sd = 1`. Portanto, se voc√™ s√≥ informar o `n`, a fun√ß√£o ir√° funcionar, considerando os valores pr√©-definidos para os demais argumentos.
- √â poss√≠vel escrever o c√≥digo sem os nomes dos argumentos, mas devem ser inseridos na mesma ordem do descrito na Ajuda.
```r
rnorm(10, 0, 1)
```
- Tamb√©m podemos trocar a ordem explicitando o nome do argumento (N√ÉO RECOMENDADO)
```r
rnorm(mean=0, n=10, sd=1)
```


## R Packages
- Pacotes s√£o cole√ß√µes de fun√ß√µes, dados e c√≥digos escritos por outras pessoas
- Por ser um software _open source_, o R possui muitos pacotes disponibilizados pela internet e muitos economistas (principalmente econometristas) j√° desenvolvem e disponibilizam pacotes com as implementa√ß√µes de seus novos m√©todos (por exemplo, Dif-in-Dif com m√∫ltiplos per√≠odos de [Callaway e Sant'Anna (2021)](https://bcallaway11.github.io/did/articles/did-basics.html)
- A instala√ß√£o de um pacote s√≥ precisa ser feita uma √∫nica vez.
- No entanto, caso voc√™ atualize uma nova vers√£o do R, √© necess√°rio instalar novamente todos os pacotes.
- Os pacotes podem ser obtidos em bibliotecas (_libraries_), como CRAN, e de indiv√≠duos (normalmente disponibilizados no GitHub)
- O CRAN √© administrado e, como existe uma curadoria para inser√ß√£o e manuten√ß√£o de pacotes novos e defasados, garante qualidade dos pacotes disponibilizados
- Tome cuidado com pacotes disponibilizados por individuos! √â poss√≠vel executar, dentro do R, c√≥digos para criar e apagar arquivos, por exemplo.

### Instala√ß√£o via CRAN
> quadrante inferior/direito > Packages > Install > (Nomes dos pacotes)

```r
install.packages("ggplot2") # Pacote para criar graficos
```

### Instala√ß√£o via GitHub
- Primeiro, √© necess√°rio instalar o pacote `devtools`
```r
install.packages("devtools")
```
- Depois, √© preciso obter o nome do author (do GitHub) e nome do pacote. Como exemplo, iremos baixar o pacote `dplyr` do autor `hadley` (este pacote, na realidade, pode ser baixado direto do CRAN).
- Para executar uma fun√ß√£o de um pacote, podemos usar `<pacote>::<funcao>`
```r
devtools::install_github("hadley/dplyr")
```

- Ou √© poss√≠vel carregar o pacote no ambiente e, depois, chamar a fun√ß√£o do pacote carregado
```r
library(devtools)
install_github("hadley/dplyr")
```

- CUIDADO! Ao carregar varios pacotes, talvez tenha 2 fun√ß√µes com mesmo nome
    - R prioriza a fun√ß√£o do pacote carregado por √∫ltimo
```{r}
library(dplyr) # Pacote para manipulacao de base de dados
library(MASS) # Normalmente nao eh carregado diretamente (via outro pacote)
```

- Uma forma de contornar o problema √© usar `<pacote>::<funcao>`
```r
select(obj) # do pacote MASS
dplyr::select(.data, ...) # do pacote dplyr
```

### Atualizando pacotes
> quadrante inferior/direito > Packages > Update > Select All > Install Updates



## Help
- Caso saiba o nome da fun√ß√£o, √© poss√≠vel olhar sua documenta√ß√£o escrevendo `?<nome_da_funcao>` (como visto anteriormente)
- Caso saiba o nome do pacote, em alguns casos funciona `?<nome_do_pacote>`, mas o ideal √© buscar sua documenta√ß√£o no CRAN (diretamente no site ou via Google)
    - Por exemplo, podemos acessar a p√°gina do [pacote `dplyr` no CRAN](https://cran.r-project.org/web/packages/dplyr/index.html):
<center><img src="../dplyr_cran.png"></center>
    - Nela √© poss√≠vel ver a partir de qual vers√£o do R funciona, os pacotes necess√°rios para o seu funcionamento (Imports), os autores e sites.
    - Em Documenta√ß√£o, √© poss√≠vel ver o seu 'Reference manual' onde s√£o expostos o objetivo do pacotes e as fun√ß√µes, incluindo explica√ß√µes de seu funcionamento.
    - Al√©m disso, pode ser interessante ver aplica√ß√µes do pacote e suas fun√ß√µes nas 'vignettes'. Normalmente s√£o expostas de maneira que podem ser replicadas no seu computador, o que acaba auxiliando na sua aplica√ß√£o (verificar estrutura de base de dados necess√°ria, sintaxes, etc.). Tamb√©m pode ser acessada diretamente do R usando a fun√ß√£o `browseVignettes()`:
```r
browseVignettes("dplyr") # Abrir√° uma p√°gina com vignettes no seu navegador
```

- Caso n√£o saiba quais fun√ß√µes/pacotes s√£o utilizados para resolver um problema, muitas vezes √© poss√≠vel encontrar a solu√ß√£o no Google utilizando palavras-chave (preferencialmente em ingl√™s) junto de "R".
<center><img src="../google_help.png"></center>
    - Al√©m de sites especializados em R e v√≠deos com exemplos de aplica√ß√µes, √© comum aparecer quest√µes no site Stack Overflow (ou em Cross Validated, pertencente ao mesmo grupo) que √© o site mais utilizado por programadores em diversas linguagens para esclarecer d√∫vidas.
    - Por R ser uma linguagem open source, h√° muitos usu√°rios e, portanto, √© comum achar perguntas/respostas que j√° solucionam o seu problema. Eventualmente, voc√™ pode fazer a sua pergunta, caso n√£o encontre uma satisfat√≥ria.
<center><img src="../stackoverflow_help.png"></center>


## GitHub Sync
N√£o ser√° detalhado aqui, mas √© algo interessante para olhar.

- [Cria√ß√£o de projetos](https://www.coursera.org/learn/data-scientists-tools/lecture/2o9zr/projects-in-r)
- [Controle de vers√£o](https://www.coursera.org/learn/data-scientists-tools/lecture/PjlHw/version-control)
- [GitHub e Git](https://www.coursera.org/learn/data-scientists-tools/lecture/VOh24/github-and-git)
- [Projetos sob controle de vers√µes](https://www.coursera.org/learn/data-scientists-tools/lecture/wbfrX/projects-under-version-control)


## R Markdown
Markdown √© uma sintaxe de formata√ß√£o simples para criar documento HTML, PDF ou Word.

Para mais detalhes de uso, veja:

- [R Markdown (John Hopkins/Coursera)](https://www.coursera.org/lecture/data-scientists-tools/r-markdown-134kE)
- Curso [_Reproducible Templates for Analysis and Dissemination_ (Emory/Coursera)]( https://www.coursera.org/learn/reproducible-templates-analysis)
- Livros: [_R Markdown: The Definitive Guide_](https://bookdown.org/yihui/rmarkdown/) e [_R Markdown Cookbook_](https://bookdown.org/yihui/rmarkdown-cookbook)



### Uso do R Markdown
Quando voc√™ clicar no bot√£o **Knit**, um documento ser√° gerado, incluindo o conte√∫do textual e os resultados dos _chunks_ com c√≥digos em R embutidos no documento.

> Para gerar em pdf, pode ser necess√°rio instalar o pacote `tinytex`

Voc√™ pode embutir um _chunk_ de c√≥digo em R: 

1. abrindo com 3 acentos graves (\`) 
2. {r nome_do_pedaco},
3. c√≥digo em R, 
4. e fechando com 3 acentos graves (\`)

Por exemplo:

````yaml
```{r cars} # Chamando esse _chunk_ com c√≥digo de R como 'cars' `r ''`
head(cars) # Visualizando 6 linhas iniciais da base de dados 'cars'
summary(cars) # Resumindo base de dados 'cars'
```
````

output:

```{r cars}
head(cars) # Visualizando 6 linhas iniciais da base de dados 'cars'
summary(cars) # Resumindo base de dados 'cars'
```

Tamb√©m, no topo do quadrante sup-esq, √© poss√≠vel criar clicando no √≠cone "+C" e selecionando "R" (ou apertando Ctrl + Alt + I).



### Incluindo Gr√°ficos
Voc√™ pode incluir gr√°ficos no documento usando `plot()` dentro do _chunk_ com c√≥digo R. Al√©m disso, o par√¢metro `echo = FALSE` retira do PDF/HTML gerado o _chunk_ de c√≥digo, gerando apenas, neste caso, a figura.

Por exemplo:

````yaml
```{r pressure, echo = FALSE}`r ''`
plot(pressure) # Gr√°fico da base de dados 'pressure'
```
````

output:

```{r pressure, echo=FALSE}
plot(pressure)
```

*Ao inv√©s de escrever `echo = FALSE`, √© poss√≠vel alterar a configura√ß√£o do _chunk_ ap√≥s cri√°-lo:<br/>  
√çcone de Config > Output > Show output only


### Formata√ß√£o no R Markdown

#### Bullets:
````yaml
- bullet 1
- bullet 2
- bullet 3
````

output:

- bullet 1
- bullet 2
- bullet 3


#### Formata√ß√£o de texto:
````yaml
1. **negrito**
2. *it√°lico* ou _it√°lico_
3. link: <http://rmarkdown.rstudio.com>.
4. [link R Markdown](http://rmarkdown.rstudio.com)
5. destaque para `c√≥digo em r`
````

output:

1. **negrito**
2. *it√°lico* ou _it√°lico_
3. link: <http://rmarkdown.rstudio.com>.
4. [link R Markdown](http://rmarkdown.rstudio.com)
5. destaque para `c√≥digo em r`



#### T√≠tulos de se√ß√µes e subse√ß√µes
````yaml
# T√≠tulo - 1¬∫ N√≠vel
## T√≠tulo - 2¬∫ N√≠vel
### T√≠tulo - 3¬∫ N√≠vel
````


### Quebra de texto
Ao terminar de escrever uma linha ou par√°grafo, √© necess√°rio apertar \<Enter\> duas vezes. Caso aperta apenas uma vez, o R Markdown considerar√° que o texto continua na mesma linha:
```yaml
N√£o pula linha
N√£o pula linha

Pula linha

Pula linha

```

output:

N√£o pula linha
N√£o pula linha

Pula linha

Pula linha


### Escrita em LaTeX
Tamb√©m √© poss√≠vel usar os c√≥digos em LaTeX para escrever express√µes matem√°ticas usando `$`:

```yaml
- Para incluir uma express√£o LaTeX no meio do texto, como $\alpha + \beta + \gamma$,
usa-se cifr√£o (`$`) √∫nico em cada lado.
- Para destacar uma express√£o, como $$\alpha + \beta + \gamma, \tag{1}$$ √© necess√°rio
colocar 2 cifr√µes (`$`) de cada lado da express√£o, assim como no LaTeX.
```

output:

- Para incluir uma express√£o em LaTeX no meio do texto, como $\alpha + \beta + \gamma$, usa-se cifr√£o (`$`) √∫nico em cada lado.
- Para destacar uma express√£o, como $$\alpha + \beta + \gamma, \tag{1}$$ √© necess√°rio colocar 2 cifr√µes (`$`) de cada lado da express√£o, assim como no LaTeX.


Para aprender a usar LaTeX:

- Curso [_LaTeX for Students, Engineers and Scientists_ (edX)](www.edx.org/course/latex-for-students-engineers-and-scientists-2) (√© poss√≠vel cursar sem pagar - _audit course_)


### Exportando documentos em outros formatos
No c√≥digo inicial do .Rmd, √© poss√≠vel alterar o formato exportado pelo documento:

- para PDF: `output: pdf_document`
- para HTML: `output: html_document`


#### Templates para HTML
Existem diversos templates para documentos HTML e, para utiliz√°-los, √© preciso instalar
o pacote `rmdsformats`

```
install.packages("rmdformats")
```

Ap√≥s a instala√ß√£o, teste:

- `output: rmdformats::material`
- `output: rmdformats::readthedown`
- `output: rmdformats::downcute`
- `output: rmdformats::robobook`
- `output: rmdformats::html_clean`
- `output: rmdformats::html_docco`



{{< cta cta_text="üëâ Proceed to R Programming" cta_link="../chapter2" >}}

